
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Type Bindings in IoC.Configuration Modules &#8212; IoC.Configuration 1.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Type Bindings in 3-rd Party Container Modules" href="native-modules.html" />
    <link rel="prev" title="Type Binding In Modules" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="native-modules.html" title="Type Bindings in 3-rd Party Container Modules"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Type Binding In Modules"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">IoC.Configuration 1.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Type Binding In Modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Type Bindings in IoC.Configuration Modules</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="type-bindings-in-ioc-configuration-modules">
<h1>Type Bindings in IoC.Configuration Modules<a class="headerlink" href="#type-bindings-in-ioc-configuration-modules" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#type-bindings-in-implementation-of-ioc-configuration-dicontainer-idimodule" id="id1">Type Bindings in Implementation of <strong>IoC.Configuration.DiContainer.IDiModule</strong></a></p></li>
<li><p><a class="reference internal" href="#types-of-bindings" id="id2">Types of Bindings</a></p>
<ul>
<li><p><a class="reference internal" href="#binding-to-self" id="id3">Binding to Self</a></p></li>
<li><p><a class="reference internal" href="#binding-to-type" id="id4">Binding to Type</a></p></li>
<li><p><a class="reference internal" href="#binding-to-a-delegate" id="id5">Binding to a Delegate</a></p></li>
<li><p><a class="reference internal" href="#specifying-resolution-scope" id="id6">Specifying Resolution Scope</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#property-injection-and-circular-references" id="id7">Property Injection and Circular References</a></p></li>
</ul>
</div>
<section id="type-bindings-in-implementation-of-ioc-configuration-dicontainer-idimodule">
<h2><a class="toc-backref" href="#id1">Type Bindings in Implementation of <strong>IoC.Configuration.DiContainer.IDiModule</strong></a><a class="headerlink" href="#type-bindings-in-implementation-of-ioc-configuration-dicontainer-idimodule" title="Permalink to this headline">¶</a></h2>
<p>Type bindings can be specified either in implementation of <strong>Load()</strong> method of interface <strong>IoC.Configuration.DiContainer.IDiModule</strong>, or in overridden method <strong>AddServiceRegistrations</strong> in <strong>IoC.Configuration.DiContainer.ModuleAbstr</strong>.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>IoC.Configuration.DiContainer.ModuleAbstr</strong> is an implementation of interface <strong>IoC.Configuration.DiContainer.IDiModule</strong>.</p>
</div>
</div></blockquote>
<p>Here is an example of specifying type bindings in overridden <strong>AddServiceRegistrations()</strong> method in a sub-class of <strong>IoC.Configuration.DiContainer.ModuleAbstr</strong>.</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">TestDiModule</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IoC</span><span class="p">.</span><span class="n">Configuration</span><span class="p">.</span><span class="n">DiContainer</span><span class="p">.</span><span class="n">ModuleAbstr</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">AddServiceRegistrations</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">Class1</span><span class="p">&gt;().</span><span class="n">ToSelf</span><span class="p">()</span><span class="w"></span>
<span class="w">                      </span><span class="p">.</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">Singleton</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">IInterface1</span><span class="p">&gt;().</span><span class="n">To</span><span class="p">&lt;</span><span class="n">Interface1_Impl1</span><span class="p">&gt;()</span><span class="w"></span>
<span class="w">                           </span><span class="p">.</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">Singleton</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">Class2</span><span class="p">&gt;().</span><span class="n">ToSelf</span><span class="p">()</span><span class="w"></span>
<span class="w">                      </span><span class="p">.</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">Transient</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">IInterface2</span><span class="p">&gt;().</span><span class="n">To</span><span class="p">&lt;</span><span class="n">Interface2_Impl1</span><span class="p">&gt;()</span><span class="w"></span>
<span class="w">                           </span><span class="p">.</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">Transient</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">Class3</span><span class="p">&gt;().</span><span class="n">ToSelf</span><span class="p">()</span><span class="w"></span>
<span class="w">                      </span><span class="p">.</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">ScopeLifetime</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">IInterface3</span><span class="p">&gt;().</span><span class="n">To</span><span class="p">&lt;</span><span class="n">Interface3_Impl1</span><span class="p">&gt;()</span><span class="w"></span>
<span class="w">                           </span><span class="p">.</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">ScopeLifetime</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">Class4</span><span class="p">&gt;().</span><span class="n">ToSelf</span><span class="p">()</span><span class="w"></span>
<span class="w">                      </span><span class="p">.</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">Singleton</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">Class4</span><span class="p">&gt;().</span><span class="n">ToSelf</span><span class="p">()</span><span class="w"></span>
<span class="w">                      </span><span class="p">.</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">Transient</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="c1">// The first binding should be with Singletone scope, and the second</span>
<span class="w">        </span><span class="c1">// should with Transient, so that we can test that the first binding was used.</span>
<span class="w">        </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">Class5</span><span class="p">&gt;().</span><span class="n">OnlyIfNotRegistered</span><span class="p">()</span><span class="w"></span>
<span class="w">                      </span><span class="p">.</span><span class="n">ToSelf</span><span class="p">().</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">Singleton</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">Class5</span><span class="p">&gt;().</span><span class="n">OnlyIfNotRegistered</span><span class="p">()</span><span class="w"></span>
<span class="w">                      </span><span class="p">.</span><span class="n">ToSelf</span><span class="p">().</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">Transient</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="c1">// Only the first binding below will be registered.</span>
<span class="w">        </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">IInterface4</span><span class="p">&gt;().</span><span class="n">OnlyIfNotRegistered</span><span class="p">().</span><span class="n">To</span><span class="p">&lt;</span><span class="n">Interface4_Impl1</span><span class="p">&gt;()</span><span class="w"></span>
<span class="w">                           </span><span class="p">.</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">Transient</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">IInterface4</span><span class="p">&gt;().</span><span class="n">OnlyIfNotRegistered</span><span class="p">().</span><span class="n">To</span><span class="p">&lt;</span><span class="n">Interface4_Impl2</span><span class="p">&gt;()</span><span class="w"></span>
<span class="w">                           </span><span class="p">.</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">Singleton</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="c1">// Both binding below will be registered</span>
<span class="w">        </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">IInterface5</span><span class="p">&gt;().</span><span class="n">OnlyIfNotRegistered</span><span class="p">()</span><span class="w"></span>
<span class="w">                           </span><span class="p">.</span><span class="n">To</span><span class="p">&lt;</span><span class="n">Interface5_Impl1</span><span class="p">&gt;()</span><span class="w"></span>
<span class="w">                           </span><span class="p">.</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">Transient</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">IInterface5</span><span class="p">&gt;().</span><span class="n">To</span><span class="p">&lt;</span><span class="n">Interface5_Impl2</span><span class="p">&gt;()</span><span class="w"></span>
<span class="w">                           </span><span class="p">.</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">Singleton</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="c1">// Test delegates and resolution using IDiContainer</span>
<span class="w">        </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">IInterface6</span><span class="p">&gt;()</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="n">To</span><span class="p">(</span><span class="n">diContainer</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Interface6_Impl1</span><span class="p">(</span><span class="m">11</span><span class="p">,</span><span class="w"> </span><span class="n">diContainer</span><span class="p">.</span><span class="n">Resolve</span><span class="p">&lt;</span><span class="n">IInterface1</span><span class="p">&gt;()));</span><span class="w"></span>


<span class="w">        </span><span class="cp">#region Test circular references</span><span class="w"></span>

<span class="w">        </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">ICircularReferenceTestInterface1</span><span class="p">&gt;()</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="n">To</span><span class="p">&lt;</span><span class="n">CircularReferenceTestInterface1_Impl</span><span class="p">&gt;()</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="n">OnImplementationObjectActivated</span><span class="p">(</span><span class="w"></span>
<span class="w">                </span><span class="p">(</span><span class="n">diContainer</span><span class="p">,</span><span class="w"> </span><span class="n">instance</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"></span>
<span class="w">                    </span><span class="c1">// Note, type of instance is the implementation type</span>
<span class="w">                    </span><span class="c1">// CircularReferenceTestInterface1_Impl. So we can use Property1 setter.</span>
<span class="w">                    </span><span class="c1">// ICircularReferenceTestInterface1 has only getter for Property1.</span>
<span class="w">                    </span><span class="n">instance</span><span class="p">.</span><span class="n">Property1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">diContainer</span><span class="p">.</span><span class="n">Resolve</span><span class="p">&lt;</span><span class="n">ICircularReferenceTestInterface2</span><span class="p">&gt;())</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">Singleton</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">ICircularReferenceTestInterface2</span><span class="p">&gt;().</span><span class="n">To</span><span class="p">&lt;</span><span class="n">CircularReferenceTestInterface2_Impl</span><span class="p">&gt;()</span><span class="w"></span>
<span class="w">                                                </span><span class="p">.</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">Singleton</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="cp">#endregion</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The examples below demonstrate dependency injection concepts supported by <strong>IoC.Configuration</strong> package. Services are resolved using an instance of <strong>IoC.Configuration.DiContainer.IDiContainer</strong>. To see how to create an instance of <strong>IoC.Configuration.DiContainer.IDiContainer</strong>, refer to sections <a class="reference internal" href="../loading-ioc-configuration/loading-from-xml.generated.html"><span class="doc">Loading from XML Configuration File</span></a> and <a class="reference internal" href="../loading-ioc-configuration/loading-from-modules.html"><span class="doc">Loading from Modules</span></a>.
In examples below, it is assumed that an instance of <strong>IoC.Configuration.DiContainer.IDiContainer</strong>, <strong>diContainer</strong>, was already creating using one of the techniques described in these sections.</p>
</div>
</section>
<section id="types-of-bindings">
<h2><a class="toc-backref" href="#id2">Types of Bindings</a><a class="headerlink" href="#types-of-bindings" title="Permalink to this headline">¶</a></h2>
<section id="binding-to-self">
<h3><a class="toc-backref" href="#id3">Binding to Self</a><a class="headerlink" href="#binding-to-self" title="Permalink to this headline">¶</a></h3>
<p>This binding type can be used to specify that the type will be re-solved to an instance of the same type.</p>
<p>Here is an example of this type of binding in overridden method <strong>IoC.Configuration.DiContainer.ModuleAbstr.AddServiceRegistrations()</strong>:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">AddServiceRegistrations</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">Class1</span><span class="p">&gt;().</span><span class="n">ToSelf</span><span class="p">()</span><span class="w"></span>
<span class="w">          </span><span class="p">.</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">Singleton</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Example of resolving the service <strong>Class1</strong>. Note, in example we use <strong>IoC.Configuration.DiContainer.IDiContainer</strong> to resolve <strong>Class1</strong> for demonstration purposes, however normally we would just use a constructor injection.</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">private</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">SelfBoundServiceDemo</span><span class="p">(</span><span class="n">IoC</span><span class="p">.</span><span class="n">Configuration</span><span class="p">.</span><span class="n">DiContainer</span><span class="p">.</span><span class="n">IDiContainer</span><span class="w"> </span><span class="n">diContainer</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">implementation</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">diContainer</span><span class="p">.</span><span class="n">Resolve</span><span class="p">&lt;</span><span class="n">Class1</span><span class="p">&gt;();</span><span class="w"></span>
<span class="w">    </span><span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">implementation</span><span class="p">.</span><span class="n">GetType</span><span class="p">()</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="k">typeof</span><span class="p">(</span><span class="n">Class1</span><span class="p">));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="binding-to-type">
<h3><a class="toc-backref" href="#id4">Binding to Type</a><a class="headerlink" href="#binding-to-type" title="Permalink to this headline">¶</a></h3>
<p>This binding type can be used to specify that type will be bound to some other type, that is either the same type, implementation or sub-class of the type being re-solved.</p>
<p>Example of this type of binding in overridden method <strong>IoC.Configuration.DiContainer.ModuleAbstr.AddServiceRegistrations()</strong>:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">AddServiceRegistrations</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//...</span>
<span class="w">    </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">IInterface2</span><span class="p">&gt;().</span><span class="n">To</span><span class="p">&lt;</span><span class="n">Interface2_Impl1</span><span class="p">&gt;()</span><span class="w"></span>
<span class="w">                       </span><span class="p">.</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">Transient</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Example of resolving the service <strong>IInterface2</strong>.</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">private</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">BindToTypeDemo</span><span class="p">(</span><span class="n">IoC</span><span class="p">.</span><span class="n">Configuration</span><span class="p">.</span><span class="n">DiContainer</span><span class="p">.</span><span class="n">IDiContainer</span><span class="w"> </span><span class="n">diContainer</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">implementation</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">diContainer</span><span class="p">.</span><span class="n">Resolve</span><span class="p">&lt;</span><span class="n">IInterface2</span><span class="p">&gt;();</span><span class="w"></span>

<span class="w">    </span><span class="n">Assert</span><span class="p">.</span><span class="n">IsTrue</span><span class="p">(</span><span class="n">implementation</span><span class="p">.</span><span class="n">GetType</span><span class="p">()</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="k">typeof</span><span class="p">(</span><span class="n">Interface2_Impl1</span><span class="p">));</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Validate that the implementation is an instance of the resolved type.</span>
<span class="w">    </span><span class="n">Assert</span><span class="p">.</span><span class="n">IsInstanceOfType</span><span class="p">(</span><span class="n">implementation</span><span class="p">,</span><span class="w"> </span><span class="k">typeof</span><span class="p">(</span><span class="n">IInterface2</span><span class="p">));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="binding-to-a-delegate">
<h3><a class="toc-backref" href="#id5">Binding to a Delegate</a><a class="headerlink" href="#binding-to-a-delegate" title="Permalink to this headline">¶</a></h3>
<p>Type is resolved to an object returned by a delegate.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The delegate that is used to create an instance of resolved type accepts as a parameter an instance of <strong>IoC.Configuration.DiContainer.IDiContainer</strong>. This parameter can be used to resolve other types, when constructing the object to return.</p>
</div>
<p>Example of this type of binding in overridden method <strong>IoC.Configuration.DiContainer.ModuleAbstr.AddServiceRegistrations()</strong>:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">AddServiceRegistrations</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//...</span>
<span class="w">    </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">IInterface6</span><span class="p">&gt;().</span><span class="n">To</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="c1">// The compiler will generate an error message if object of type IInterface6 is not assignable from an object of type Interface6_Impl1.</span>
<span class="w">    </span><span class="n">diContainer</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Interface6_Impl1</span><span class="p">(</span><span class="m">11</span><span class="p">,</span><span class="w"> </span><span class="n">diContainer</span><span class="p">.</span><span class="n">Resolve</span><span class="p">&lt;</span><span class="n">IInterface1</span><span class="p">&gt;()));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Example of resolving the service <strong>IInterface6</strong>.</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">private</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">BindToAValueReturnedByDelegate</span><span class="p">(</span><span class="n">IoC</span><span class="p">.</span><span class="n">Configuration</span><span class="p">.</span><span class="n">DiContainer</span><span class="p">.</span><span class="n">IDiContainer</span><span class="w"> </span><span class="n">diContainer</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//...</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">implementation</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">diContainer</span><span class="p">.</span><span class="n">Resolve</span><span class="p">&lt;</span><span class="n">IInterface6</span><span class="p">&gt;();</span><span class="w"></span>
<span class="w">    </span><span class="n">Assert</span><span class="p">.</span><span class="n">IsInstanceOfType</span><span class="p">(</span><span class="n">implementation</span><span class="p">,</span><span class="w"> </span><span class="k">typeof</span><span class="p">(</span><span class="n">IInterface6</span><span class="p">));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="specifying-resolution-scope">
<h3><a class="toc-backref" href="#id6">Specifying Resolution Scope</a><a class="headerlink" href="#specifying-resolution-scope" title="Permalink to this headline">¶</a></h3>
<p>For more details on resolution scope, refer to section <a class="reference internal" href="../resolving-types/resolution-scopes.html"><span class="doc">Resolution Scopes</span></a>.
Here we will just mention that all three resolution scopes are supporetd in <strong>IoC.Configuration</strong> modules.</p>
<p>Here are some examples on how to specify the resolution scope in overridden method <strong>IoC.Configuration.DiContainer.ModuleAbstr.AddServiceRegistrations()</strong>.</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">AddServiceRegistrations</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">Class1</span><span class="p">&gt;().</span><span class="n">ToSelf</span><span class="p">().</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">Singleton</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">IInterface4</span><span class="p">&gt;().</span><span class="n">To</span><span class="p">&lt;</span><span class="n">Interface4_Impl1</span><span class="p">&gt;().</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">Transient</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">IInterface3</span><span class="p">&gt;().</span><span class="n">To</span><span class="p">&lt;</span><span class="n">Interface3_Impl1</span><span class="p">&gt;().</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">ScopeLifetime</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="property-injection-and-circular-references">
<h2><a class="toc-backref" href="#id7">Property Injection and Circular References</a><a class="headerlink" href="#property-injection-and-circular-references" title="Permalink to this headline">¶</a></h2>
<p>The most common dependency injection type is a constructor injection, when dependency injection container creates objects and injects them into constructor of an object being resolved (this process is done recursively).</p>
<p>However, there are scenarios when two types reference each other. In this case constructor injection might fail. For example if type <strong>TypeA</strong> is specified as a constructor parameter in type <strong>TypeB</strong> and <strong>TypeB</strong> is specified as a constructor parameter in type <strong>TypeA</strong>, the dependency injection container will not be able to create an instance of <strong>TypeA</strong>, since it will need to create an instance of type <strong>TypeB</strong>, which requires creating an instance of type <strong>TypeA</strong>.</p>
<p>In such cases, property injection can be used to re-solve circular references. In this example type <strong>TypeB</strong> can be specified as a constructor parameter in type <strong>TypeA</strong>, and type <strong>TypeA</strong> can be a type of property <strong>TypeB.TypeAProperty</strong>, which will be initialized after the DI container created both types.</p>
<p>Here is an example of how property injection can be implemented in overridden <strong>AddServiceRegistrations()</strong> method in a sub-class of <strong>IoC.Configuration.DiContainer.ModuleAbstr</strong>:</p>
<p>In this example, the constructor of type <strong>CircularReferenceTestInterface2_Impl</strong> has a parameter of type <strong>ICircularReferenceTestInterface1</strong>, and the implementation of <strong>ICircularReferenceTestInterface1</strong>, <strong>CircularReferenceTestInterface1_Impl</strong>, has a setter property <strong>Property1</strong> of type <strong>ICircularReferenceTestInterface2</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The setter property used for property injection needs to be declared in implementation only.</p>
</div>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">TestDiModule</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IoC</span><span class="p">.</span><span class="n">Configuration</span><span class="p">.</span><span class="n">DiContainer</span><span class="p">.</span><span class="n">ModuleAbstr</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">AddServiceRegistrations</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">ICircularReferenceTestInterface1</span><span class="p">&gt;()</span><span class="w"></span>
<span class="w">                    </span><span class="p">.</span><span class="n">To</span><span class="p">&lt;</span><span class="n">CircularReferenceTestInterface1_Impl</span><span class="p">&gt;()</span><span class="w"></span>
<span class="w">                    </span><span class="p">.</span><span class="n">OnImplementationObjectActivated</span><span class="p">(</span><span class="w"></span>
<span class="w">                        </span><span class="p">(</span><span class="n">diContainer</span><span class="p">,</span><span class="w"> </span><span class="n">instance</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"></span>
<span class="w">                         </span><span class="c1">// Note, type of parameter &#39;instance&#39; is the implementation type</span>
<span class="w">                         </span><span class="c1">// CircularReferenceTestInterface1_Impl. So we can use Property1 setter in</span>
<span class="w">                         </span><span class="c1">// CircularReferenceTestInterface1_Impl only and not in ICircularReferenceTestInterface1.</span>
<span class="w">                         </span><span class="c1">// ICircularReferenceTestInterface1 has only getter for Property1.</span>
<span class="w">                         </span><span class="n">instance</span><span class="p">.</span><span class="n">Property1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">diContainer</span><span class="p">.</span><span class="n">Resolve</span><span class="p">&lt;</span><span class="n">ICircularReferenceTestInterface2</span><span class="p">&gt;())</span><span class="w"></span>
<span class="w">                    </span><span class="p">.</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">Singleton</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="n">Bind</span><span class="p">&lt;</span><span class="n">ICircularReferenceTestInterface2</span><span class="p">&gt;().</span><span class="n">To</span><span class="p">&lt;</span><span class="n">CircularReferenceTestInterface2_Impl</span><span class="p">&gt;()</span><span class="w"></span>
<span class="w">                                                </span><span class="p">.</span><span class="n">SetResolutionScope</span><span class="p">(</span><span class="n">DiResolutionScope</span><span class="p">.</span><span class="n">Singleton</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Type Bindings in IoC.Configuration Modules</a><ul>
<li><a class="reference internal" href="#type-bindings-in-implementation-of-ioc-configuration-dicontainer-idimodule">Type Bindings in Implementation of <strong>IoC.Configuration.DiContainer.IDiModule</strong></a></li>
<li><a class="reference internal" href="#types-of-bindings">Types of Bindings</a><ul>
<li><a class="reference internal" href="#binding-to-self">Binding to Self</a></li>
<li><a class="reference internal" href="#binding-to-type">Binding to Type</a></li>
<li><a class="reference internal" href="#binding-to-a-delegate">Binding to a Delegate</a></li>
<li><a class="reference internal" href="#specifying-resolution-scope">Specifying Resolution Scope</a></li>
</ul>
</li>
<li><a class="reference internal" href="#property-injection-and-circular-references">Property Injection and Circular References</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="index.html"
                          title="previous chapter">Type Binding In Modules</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="native-modules.html"
                          title="next chapter">Type Bindings in 3-rd Party Container Modules</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/bindings-in-modules/ioc-configuration-modules.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="native-modules.html" title="Type Bindings in 3-rd Party Container Modules"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Type Binding In Modules"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">IoC.Configuration 1.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Type Binding In Modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Type Bindings in IoC.Configuration Modules</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Artak Hakobyan.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>
  </body>
</html>